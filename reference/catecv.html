<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Provides (doubly robust) estimation of the average treatment effect (ATE) for count, survival or continuous
outcomes in nested and mutually exclusive subgroups of patients defined by an estimated conditional
average treatment effect (CATE) score via cross-validation (CV)."><title>Cross-validation of the conditional average treatment effect (CATE) score for count, survival or continuous outcomes — catecv • precmed</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-validation of the conditional average treatment effect (CATE) score for count, survival or continuous outcomes — catecv"><meta property="og:description" content="Provides (doubly robust) estimation of the average treatment effect (ATE) for count, survival or continuous
outcomes in nested and mutually exclusive subgroups of patients defined by an estimated conditional
average treatment effect (CATE) score via cross-validation (CV)."><meta property="og:image" content="https://smartdata-analysis-and-statistics.github.io/precmed/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">precmed</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/Count-examples.html">Example with count outcome</a>
    <a class="dropdown-item" href="../articles/Survival-examples.html">Example with survival outcome</a>
    <a class="dropdown-item" href="../articles/Additional-examples.html">Additional examples</a>
    <a class="dropdown-item" href="../articles/Theoretical-details.html">Theoretical details</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/smartdata-analysis-and-statistics/precmed">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Cross-validation of the conditional average treatment effect (CATE) score for count, survival or continuous outcomes</h1>
      <small class="dont-index">Source: <a href="https://github.com/smartdata-analysis-and-statistics/precmed/blob/HEAD/R/crossv.R" class="external-link"><code>R/crossv.R</code></a></small>
      <div class="d-none name"><code>catecv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Provides (doubly robust) estimation of the average treatment effect (ATE) for count, survival or continuous
outcomes in nested and mutually exclusive subgroups of patients defined by an estimated conditional
average treatment effect (CATE) score via cross-validation (CV).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">catecv</span><span class="op">(</span></span>
<span>  <span class="va">response</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">score.method</span>,</span>
<span>  <span class="va">cate.model</span>,</span>
<span>  <span class="va">ps.model</span>,</span>
<span>  ps.method <span class="op">=</span> <span class="st">"glm"</span>,</span>
<span>  init.model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initial.predictor.method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ipcw.model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ipcw.method <span class="op">=</span> <span class="st">"breslow"</span>,</span>
<span>  minPS <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  maxPS <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  followup.time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tau0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  higher.y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prop.cutoff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>  prop.multi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  abc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  train.prop <span class="op">=</span> <span class="fl">3</span><span class="op">/</span><span class="fl">4</span>,</span>
<span>  cv.n <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  error.max <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  surv.min <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  xvar.smooth.score <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xvar.smooth.init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tree.depth <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n.trees.rf <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  n.trees.boosting <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  Kfold <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  error.maxNR <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  max.iterNR <span class="op">=</span> <span class="fl">150</span>,</span>
<span>  tune <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot.gbmperf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>response</dt>
<dd><p>A string describing the type of outcome in the data.
Allowed values include "count" (see <code><a href="catecvcount.html">catecvcount</a>()</code>), "survival"
(see <code><a href="catecvsurv.html">catecvsurv</a>()</code>) and "continuous" (see
<code><a href="catecvmean.html">catecvmean</a>()</code>) .</p></dd>


<dt>data</dt>
<dd><p>A data frame containing the variables in the outcome, propensity score, and inverse
probability of censoring models (if specified); a data frame with <code>n</code> rows (1 row per observation).</p></dd>


<dt>score.method</dt>
<dd><p>A vector of one or multiple methods to estimate the CATE score.
Allowed values are: <code>'boosting'</code>, <code>'twoReg'</code>, <code>'contrastReg'</code>, <code>'poisson'</code> (count and survival outcomes only),
<code>'randomForest'</code> (survival, continuous outcomes only), <code>negBin</code> (count outcomes only), <code>'gam'</code> (continuous outcomes only),
<code>'gaussian'</code> (continuous outcomes only).</p></dd>


<dt>cate.model</dt>
<dd><p>A formula describing the outcome model to be fitted.
The outcome must appear on the left-hand side. For survival outcomes, a
<code>Surv</code> object must be used to describe the outcome.</p></dd>


<dt>ps.model</dt>
<dd><p>A formula describing the propensity score (PS) model to be fitted. The treatment must
appear on the left-hand side. The treatment must be a numeric vector coded as 0/1.
If data are from a randomized controlled trial, specify <code>ps.model = ~1</code> as an intercept-only model.</p></dd>


<dt>ps.method</dt>
<dd><p>A character value for the method to estimate the propensity score.
Allowed values include one of:
<code>'glm'</code> for logistic regression with main effects only (default), or
<code>'lasso'</code> for a logistic regression with main effects and LASSO penalization on
two-way interactions (added to the model if interactions are not specified in <code>ps.model</code>).
Relevant only when <code>ps.model</code> has more than one variable.</p></dd>


<dt>init.model</dt>
<dd><p>A formula describing the initial predictor model. The outcome must appear on the left-hand side.
It must be specified when <code>score.method = contrastReg</code> or <code>twoReg</code>.</p></dd>


<dt>initial.predictor.method</dt>
<dd><p>A character vector for the method used to get initial
outcome predictions conditional on the covariates specified in <code>cate.model</code>. Only applies
when <code>score.method</code> includes <code>'twoReg'</code> or <code>'contrastReg'</code>. Allowed values include one of
<code>'randomForest'</code> (survival outcomes only), <code>'boosting'</code>, <code>'logistic'</code>
(survival outcomes only, fast), <code>'poisson'</code> (count outcomes only, fast), <code>'gaussian'</code> (continuous outcomes only) and
<code>'gam'</code> (count and continuous outcomes only). Default is <code>NULL</code>, which assigns <code>'boosting'</code>
for count outcomes and <code>'randomForest'</code> for survival outcomes.</p></dd>


<dt>ipcw.model</dt>
<dd><p>A formula describing the inverse probability of censoring weighting (IPCW)
model to be fitted. The left-hand side must be empty. Only applies for survival outcomes.
Default is <code>NULL</code>, which corresponds to specifying the IPCW with the same covariates
as the outcome model <code>cate.model</code>, plus the treatment.</p></dd>


<dt>ipcw.method</dt>
<dd><p>A character value for the censoring model. Only applies for survival
outcomes. Allowed values are: <code>'breslow'</code> (Cox regression with Breslow estimator of t
he baseline survivor function), <code>'aft (exponential)'</code>, <code>'aft (weibull)'</code>,
<code>'aft (lognormal)'</code> or <code>'aft (loglogistic)'</code> (accelerated failure time model
with different distributions for y variable). Default is <code>'breslow'</code>.</p></dd>


<dt>minPS</dt>
<dd><p>A numerical value (in [0, 1]) below which estimated propensity scores should be
truncated. Default is <code>0.01</code>.</p></dd>


<dt>maxPS</dt>
<dd><p>A numerical value (in (0, 1]) above which estimated propensity scores should be
truncated. Must be strictly greater than <code>minPS</code>. Default is <code>0.99</code>.</p></dd>


<dt>followup.time</dt>
<dd><p>A column name in <code>data</code> specifying the maximum follow-up time,
interpreted as the potential censoring time. Only applies for survival outcomes.
Default is <code>NULL</code>, which corresponds to unknown potential censoring time.</p></dd>


<dt>tau0</dt>
<dd><p>The truncation time for defining restricted mean time lost. Only applies for
survival outcomes. Default is <code>NULL</code>, which corresponds to setting the truncation time as the
maximum survival time in the data.</p></dd>


<dt>higher.y</dt>
<dd><p>A logical value indicating whether higher (<code>TRUE</code>) or
lower (<code>FALSE</code>) values of the outcome are more desirable. Default is <code>TRUE</code>.</p></dd>


<dt>prop.cutoff</dt>
<dd><p>A vector of numerical values (in (0, 1]) specifying percentiles of the
estimated log CATE scores to define nested subgroups. Each element represents the cutoff to
separate observations in nested subgroups (below vs above cutoff).
The length of <code>prop.cutoff</code> is the number of nested subgroups.
An equally-spaced sequence of proportions ending with 1 is recommended.
Default is <code>seq(0.5, 1, length = 6)</code>.</p></dd>


<dt>prop.multi</dt>
<dd><p>A vector of numerical values (in [0, 1]) specifying percentiles of the
estimated log CATE scores to define mutually exclusive subgroups.
It should start with 0, end with 1, and be of <code>length(prop.multi) &gt; 2</code>.
Each element represents the cutoff to separate the observations into
<code>length(prop.multi) - 1</code> mutually exclusive subgroups.
Default is <code>c(0, 1/3, 2/3, 1)</code>.</p></dd>


<dt>abc</dt>
<dd><p>A logical value indicating whether the area between curves (ABC) should be calculated
at each cross-validation iterations, for each <code>score.method</code>. Default is <code>TRUE</code>.</p></dd>


<dt>train.prop</dt>
<dd><p>A numerical value (in (0, 1)) indicating the proportion of total data used
for training. Default is <code>3/4</code>.</p></dd>


<dt>cv.n</dt>
<dd><p>A positive integer value indicating the number of cross-validation iterations.
Default is <code>10</code>.</p></dd>


<dt>error.max</dt>
<dd><p>A numerical value &gt; 0 indicating the tolerance (maximum value of error)
for the largest standardized absolute difference in the covariate distributions or in the
doubly robust estimated rate ratios between the training and validation sets. This is used
to define a balanced training-validation splitting. Default is <code>0.1</code>.</p></dd>


<dt>max.iter</dt>
<dd><p>A positive integer value indicating the maximum number of iterations when
searching for a balanced training-validation split. Default is <code>5,000</code>.</p></dd>


<dt>surv.min</dt>
<dd><p>Lower truncation limit for the probability of being censored.
It must be a positive value and should be chosen close to 0. Only applies for survival
outcomes. Default is <code>0.025</code>.</p></dd>


<dt>xvar.smooth.score</dt>
<dd><p>A vector of characters indicating the name of the variables used as
the smooth terms if <code>score.method = 'gam'</code>. The variables must be selected
from the variables listed in <code>cate.model</code>.</p></dd>


<dt>xvar.smooth.init</dt>
<dd><p>A vector of characters indicating the name of the variables used as
the smooth terms if <code>initial.predictor.method = 'gam'</code>. The variables must be selected
from the variables listed in <code>init.model</code>.
Default is <code>NULL</code>, which uses all variables in <code>init.model</code>.</p></dd>


<dt>tree.depth</dt>
<dd><p>A positive integer specifying the depth of individual trees in boosting
(usually 2-3). Used only if <code>score.method = 'boosting'</code> or
if <code>initial.predictor.method = 'boosting'</code> with <code>score.method = 'twoReg'</code> or
<code>'contrastReg'</code>. Default is 2.</p></dd>


<dt>n.trees.rf</dt>
<dd><p>A positive integer specifying the maximum number of trees in random forest.
Used if <code>score.method = 'ranfomForest'</code> or if <code>initial.predictor.method = 'randomForest'</code>
with <code>score.method = 'twoReg'</code> or <code>'contrastReg'</code>. Only applies for survival outcomes.
Default is <code>1000</code>.</p></dd>


<dt>n.trees.boosting</dt>
<dd><p>A positive integer specifying the maximum number of trees in boosting
(usually 100-1000). Used if <code>score.method = 'boosting'</code> or
if <code>initial.predictor.method = 'boosting'</code> with <code>score.method = 'twoReg'</code> or
<code>'contrastReg'</code>. Default is <code>200</code>.</p></dd>


<dt>B</dt>
<dd><p>A positive integer specifying the number of time cross-fitting is repeated in
<code>score.method = 'twoReg'</code> and <code>'contrastReg'</code>. Default is <code>3</code>.</p></dd>


<dt>Kfold</dt>
<dd><p>A positive integer specifying the number of folds used in cross-fitting
to partition the data in <code>score.method = 'twoReg'</code> and <code>'contrastReg'</code>.
Default is <code>5</code>.</p></dd>


<dt>error.maxNR</dt>
<dd><p>A numerical value &gt; 0 indicating the minimum value of the mean absolute
error in Newton Raphson algorithm. Used only if <code>score.method = 'contrastReg'</code>.
Default is <code>0.001</code>.</p></dd>


<dt>max.iterNR</dt>
<dd><p>A positive integer indicating the maximum number of iterations in the
Newton Raphson algorithm. Used only if <code>score.method = 'contrastReg'</code>.
Default is <code>150</code>.</p></dd>


<dt>tune</dt>
<dd><p>A vector of 2 numerical values &gt; 0 specifying tuning parameters for the
Newton Raphson algorithm. <code>tune[1]</code> is the step size, <code>tune[2]</code> specifies a
quantity to be added to diagonal of the slope matrix to prevent singularity.
Used only if <code>score.method = 'contrastReg'</code>. Default is <code>c(0.5, 2)</code>.</p></dd>


<dt>seed</dt>
<dd><p>An optional integer specifying an initial randomization seed for reproducibility.
Default is <code>NULL</code>, corresponding to no seed.</p></dd>


<dt>plot.gbmperf</dt>
<dd><p>A logical value indicating whether to plot the performance measures in
boosting. Used only if <code>score.method = 'boosting'</code> or if <code>score.method = 'twoReg'</code>
or <code>'contrastReg'</code> and <code>initial.predictor.method = 'boosting'</code>. Default is <code>TRUE</code>.</p></dd>


<dt>verbose</dt>
<dd><p>An integer value indicating what kind of intermediate progress messages should
be printed. <code>0</code> means no outputs. <code>1</code> means only progress bar and run time.
<code>2</code> means progress bar, run time, and all errors and warnings. Default is <code>0</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>For count response, see description of outputs in <code><a href="catecvcount.html">catecvcount</a>()</code>.
For survival response, see description of outputs in <code><a href="catecvsurv.html">catecvsurv</a>()</code>.
For continuous response, see description of outputs in <code><a href="catecvmean.html">catecvmean</a>()</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For count response, see details in <code><a href="catecvcount.html">catecvcount</a>()</code>.
For survival response, see details in <code><a href="catecvsurv.html">catecvsurv</a>()</code>.
For continuous response, see details in <code><a href="catecvmean.html">catecvmean</a>()</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Yadlowsky, S., Pellegrini, F., Lionetto, F., Braune, S., &amp; Tian, L. (2020).
<em>Estimation and validation of ratio-based conditional average treatment effects using
observational data. Journal of the American Statistical Association, 1-18.</em>
<a href="https://www.tandfonline.com/doi/full/10.1080/01621459.2020.1772080" class="external-link">https://www.tandfonline.com/doi/full/10.1080/01621459.2020.1772080</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="catefit.html">catefit</a>()</code> function and <code><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a>()</code>, <code><a href="abc.html">abc</a></code> methods for
<code>"precmed"</code> objects.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">cate_1</span> <span class="op">&lt;-</span> <span class="fu">catecv</span><span class="op">(</span>response <span class="op">=</span> <span class="st">"count"</span>,</span></span>
<span class="r-in"><span>                 data <span class="op">=</span> <span class="va">countExample</span>,</span></span>
<span class="r-in"><span>                 score.method <span class="op">=</span> <span class="st">"poisson"</span>,</span></span>
<span class="r-in"><span>                 cate.model <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">previous_treatment</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                              <span class="va">previous_cost</span> <span class="op">+</span> <span class="va">previous_number_relapses</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                              <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">years</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 ps.model <span class="op">=</span> <span class="va">trt</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">previous_treatment</span>,</span></span>
<span class="r-in"><span>                 higher.y <span class="op">=</span> <span class="cn">FALSE</span>, cv.n <span class="op">=</span> <span class="fl">5</span>, seed <span class="op">=</span> <span class="fl">999</span>, verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Variable trt was recoded to 0/1 with drug0-&gt;0 and drug1-&gt;1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cv = 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   splitting the data..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   training..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   validating..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cv = 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   splitting the data..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   training..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   validating..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cv = 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   splitting the data..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   training..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   validating..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cv = 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   splitting the data..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   training..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   validating..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cv = 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   splitting the data..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   training..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   validating..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total runtime : 11.44 secs </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cate_1</span>, ylab <span class="op">=</span> <span class="st">"RMTL ratio of drug1 vs drug0 in each subgroup"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="catecv-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">cate_1</span>, ylab <span class="op">=</span> <span class="st">"RMTL ratio of drug1 vs drug0 in each subgroup"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="catecv-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="abc.html">abc</a></span><span class="op">(</span><span class="va">cate_1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               cv1       cv2       cv3        cv4       cv5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> poisson 0.1375899 0.1172791 0.1120313 0.06136285 0.1877103</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Survival outcome</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tau0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">survivalExample</span>,</span></span>
<span class="r-in"><span>             <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">trt</span> <span class="op">==</span> <span class="st">"drug1"</span><span class="op">]</span>, <span class="fl">0.95</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">trt</span> <span class="op">==</span> <span class="st">"drug0"</span><span class="op">]</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cate_2</span> <span class="op">&lt;-</span> <span class="fu">catecv</span><span class="op">(</span>response <span class="op">=</span> <span class="st">"survival"</span>,</span></span>
<span class="r-in"><span>                 data <span class="op">=</span> <span class="va">survivalExample</span>,</span></span>
<span class="r-in"><span>                 score.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"poisson"</span>, <span class="st">"randomForest"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 cate.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">d</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">previous_cost</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                              <span class="va">previous_number_relapses</span>,</span></span>
<span class="r-in"><span>                 ps.model <span class="op">=</span> <span class="va">trt</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">previous_treatment</span>,</span></span>
<span class="r-in"><span>                 initial.predictor.method <span class="op">=</span> <span class="st">"randomForest"</span>,</span></span>
<span class="r-in"><span>                 ipcw.model <span class="op">=</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">previous_cost</span> <span class="op">+</span> <span class="va">previous_treatment</span>,</span></span>
<span class="r-in"><span>                 tau0 <span class="op">=</span> <span class="va">tau0</span>,</span></span>
<span class="r-in"><span>                 higher.y <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 surv.min <span class="op">=</span> <span class="fl">0.025</span>,</span></span>
<span class="r-in"><span>                 cv.n <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                 seed <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Variable trt was recoded to 0/1 with drug0-&gt;0 and drug1-&gt;1.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cate_2</span>, ylab <span class="op">=</span> <span class="st">"RMTL ratio of drug1 vs drug0 in each subgroup"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="catecv-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">cate_2</span>, ylab <span class="op">=</span> <span class="st">"RMTL ratio of drug1 vs drug0 in each subgroup"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 10 rows containing non-finite values (`stat_boxplot()`).</span>
<span class="r-plt img"><img src="catecv-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="abc.html">abc</a></span><span class="op">(</span><span class="va">cate_2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    cv1       cv2       cv3       cv4        cv5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> poisson      0.2165482 0.2183456 0.1012403 0.2153617 0.09806659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> randomForest 0.2251578 0.2014423 0.1480573 0.2431572 0.15568445</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Lu Tian, Xiaotong Jiang, Gabrielle Simoneau, Thomas Debray.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

