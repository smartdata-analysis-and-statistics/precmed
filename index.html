<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A doubly robust precision medicine approach to fit, cross-validate and visualize prediction models for the conditional average treatment effect (CATE). It implements doubly robust estimation and semiparametric modeling approach of treatment-covariate interactions as proposed by Yadlowsky et al. (2020) &lt;doi:10.1080/01621459.2020.1772080&gt;.">
<title>Precision Medicine • precmed</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Precision Medicine">
<meta property="og:description" content="A doubly robust precision medicine approach to fit, cross-validate and visualize prediction models for the conditional average treatment effect (CATE). It implements doubly robust estimation and semiparametric modeling approach of treatment-covariate interactions as proposed by Yadlowsky et al. (2020) &lt;doi:10.1080/01621459.2020.1772080&gt;.">
<meta property="og:image" content="https://smartdata-analysis-and-statistics.github.io/precmed/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">precmed</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="articles/Count-examples.html">Example with count outcome</a>
    <a class="dropdown-item" href="articles/Survival-examples.html">Example with survival outcome</a>
    <a class="dropdown-item" href="articles/Additional-examples.html">Additional examples</a>
    <a class="dropdown-item" href="articles/Theoretical-details.html">Theoretical details</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/smartdata-analysis-and-statistics/precmed">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="precmed-">precmed <a class="anchor" aria-label="anchor" href="#precmed-"></a>
</h1>
</div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><strong>precmed</strong> was developed to help researchers with the implementation of precision medicine in R. A key objective of precision medicine is to determine the optimal treatment separately for each patient instead of applying a common treatment to all patients. Personalizing treatment decisions becomes particularly relevant when treatment response differs across patients, or when patients have different preferences about benefits and harms. This package offers statistical methods to develop and validate prediction models for estimating individualized treatment effects. These treatment effects are also known as the conditional average treatment effects (CATEs) and describe how different subgroups of patients respond to the same treatment. Presently, <strong>precmed</strong> focuses on the personalization of two competitive treatments using randomized data from a clinical trial (Zhao et al. 2013) or using real-world data (RWD) from a non-randomized study (Yadlowsky et al. 2020).</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The <code>precmed</code> package can be installed from CRAN as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"precmed"</span><span class="op">)</span></span></code></pre></div>
<p>The latest version can be installed from GitHub as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"smartdata-analysis-and-statistics/precmed"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="package-capabilities">Package capabilities<a class="anchor" aria-label="anchor" href="#package-capabilities"></a>
</h2>
<p>The main functions in the <strong>precmed</strong> package are:</p>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<a href="https://smartdata-analysis-and-statistics.github.io/precmed/reference/catefit.html">catefit</a>()</td>
<td>Estimation of the conditional average treatment effect (CATE)</td>
</tr>
<tr class="even">
<td>
<a href="https://smartdata-analysis-and-statistics.github.io/precmed/reference/atefit.html">atefit</a>()</td>
<td>Doubly robust estimator for the average treatment effect (ATE)</td>
</tr>
<tr class="odd">
<td>
<a href="https://smartdata-analysis-and-statistics.github.io/precmed/reference/catecv.html">catecv</a>()</td>
<td>Development and cross-validation of the CATE</td>
</tr>
<tr class="even">
<td>
<a href="https://smartdata-analysis-and-statistics.github.io/precmed/reference/abc.html">abc</a>()</td>
<td>Compute the area between the average treatment difference curve of competing models for the CATE (Zhao et al. 2013)</td>
</tr>
<tr class="odd">
<td>
<a href="https://smartdata-analysis-and-statistics.github.io/precmed/reference/plot.precmed.html">plot</a>()</td>
<td>Two side-by-side line plots of validation curves from the <code>precmed</code> object</td>
</tr>
<tr class="even">
<td>
<a href="https://smartdata-analysis-and-statistics.github.io/precmed/reference/boxplot.precmed.html">boxplot</a>()</td>
<td>Plot the proportion of subjects with an estimated treatment effect no less than <span class="math inline"><em>c</em></span> over a range of values for <span class="math inline"><em>c</em></span> (Zhao et al. 2013).</td>
</tr>
</tbody>
</table>
<p>For more info: <a href="https://smartdata-analysis-and-statistics.github.io/precmed/" class="uri">https://smartdata-analysis-and-statistics.github.io/precmed/</a></p>
</div>
<div class="section level2">
<h2 id="recommended-workflow">Recommended workflow<a class="anchor" aria-label="anchor" href="#recommended-workflow"></a>
</h2>
<p>We recommend the following workflow to develop a model for estimating the CATE in order to identify treatment effect heterogeneity:</p>
<ol style="list-style-type: decimal">
<li>Compare up to five modelling approaches (e.g., Poisson regression, boosting) for estimating the CATE using cross-validation through <a href="https://smartdata-analysis-and-statistics.github.io/precmed/reference/catecv.html">catecv</a>.</li>
<li>Select the best modelling approach using 3 metrics:
<ul>
<li>Compare the steepness of the validation curves in the validation samples across methods using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>. Two side-by-side plots are generated, visualizing the estimated average treatment effects in a series of nested subgroups. On the left side the curve is shown for the training set, and on the right side the curve is shown for the validation set. Each line in the plots represents one scoring method (e.g., boosting, randomForest) specified under the argument <code>score.method</code>.</li>
<li>The area between curves (ABC) using <a href="https://smartdata-analysis-and-statistics.github.io/precmed/reference/abc.html">abc</a> quantifies a model’s ability to capture treatment effect heterogeneity. Higher ABC values are preferable as they indicate that more treatment effect heterogeneity is captured by the scoring method.</li>
<li>Compare the distribution of the estimated ATE across different levels of the CATE score percentiles using <code><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot()</a></code>.</li>
</ul>
</li>
<li>Apply the best modelling approach in the original data or in a new external dataset using <code><a href="reference/catefit.html">catefit()</a></code>.</li>
<li>Optional. Use <code><a href="reference/atefit.html">atefit()</a></code> to estimate ATE between 2 treatment groups with a doubly robust estimator and estimate the variability of the ATE with a bootstrap approach.</li>
</ol>
<p>In the vignettes, we will adopt a different workflow to gradually expose the user from simple to more complex methods.</p>
</div>
<div class="section level2">
<h2 id="user-input">User input<a class="anchor" aria-label="anchor" href="#user-input"></a>
</h2>
<p>When applying <code><a href="reference/catefit.html">catefit()</a></code> or <code><a href="reference/catecv.html">catecv()</a></code>, the user has to (at least) input:</p>
<ul>
<li>
<code>response</code>: type of outcome/response (either <code>count</code> or <code>survival</code>)<br>
</li>
<li>
<code>data</code>: a data frame with individual patient data<br>
</li>
<li>
<code>score.method</code>: methods to estimate the CATE (e.g., <code>boosting</code>, <code>poisson</code>, <code>twoReg</code>, <code>contrastReg</code>)<br>
</li>
<li>
<code>cate.model</code>: a formula describing the outcome model (e.g., outcome ~ age + gender + previous_treatment)<br>
</li>
<li>
<code>ps.model</code>: a formula describing the propensity score model to adjust for confounding (e.g., treatment ~ age + previous_treatment)</li>
</ul>
</div>
<div class="section level2">
<h2 id="vignettes">Vignettes<a class="anchor" aria-label="anchor" href="#vignettes"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<a href="https://smartdata-analysis-and-statistics.github.io/precmed/articles/Count-examples.html">Examples with count outcome of the entire workflow</a><br>
</li>
<li>
<a href="https://smartdata-analysis-and-statistics.github.io/precmed/articles/Survival-examples.html">Examples with survival outcome of the entire workflow</a><br>
</li>
<li>
<a href="https://smartdata-analysis-and-statistics.github.io/precmed/articles/Additional-examples.html">Additional examples for the <code>precmed</code> package</a><br>
</li>
<li><a href="https://smartdata-analysis-and-statistics.github.io/precmed/articles/Theoretical-details.html">Theoretical details</a></li>
</ol>
</div>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-yadlowsky2020estimation" class="csl-entry">
Yadlowsky, Steve, Fabio Pellegrini, Federica Lionetto, Stefan Braune, and Lu Tian. 2020. “Estimation and Validation of Ratio-Based Conditional Average Treatment Effects Using Observational Data.” <em>Journal of the American Statistical Association</em>, 1–18.
</div>
<div id="ref-zhao2013effectively" class="csl-entry">
Zhao, Lihui, Lu Tian, Tianxi Cai, Brian Claggett, and Lee-Jen Wei. 2013. “Effectively Selecting a Target Population for a Future Comparative Study.” <em>Journal of the American Statistical Association</em> 108 (502): 527–39. <a href="https://doi.org/10.1080/01621459.2013.770705" class="external-link uri">https://doi.org/10.1080/01621459.2013.770705</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=precmed" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/smartdata-analysis-and-statistics/precmed/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/smartdata-analysis-and-statistics/precmed/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>Apache License (== 2.0)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing precmed</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Lu Tian <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5893-0169" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Xiaotong Jiang <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-3698-4526" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Gabrielle Simoneau <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-9310-6274" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Thomas Debray <br><small class="roles"> Contributor, maintainer </small> <a href="https://orcid.org/0000-0002-1790-2719" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=precmed" class="external-link"><img src="https://www.r-pkg.org/badges/version/precmed" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=precmed" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/last-month/precmed" alt="metacran downloads"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lu Tian, Xiaotong Jiang, Gabrielle Simoneau, Thomas Debray.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
